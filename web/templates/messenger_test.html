<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Messenger Test - Study Buddy System</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .recipient-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            margin-bottom: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .recipient-item input {
            flex: 1;
        }

        .recipient-item .test-btn {
            min-width: 80px;
        }

        .test-result {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 4px;
            display: none;
        }

        .test-result.success {
            background: #d4edda;
            color: #155724;
            display: inline-block;
        }

        .test-result.error {
            background: #f8d7da;
            color: #721c24;
            display: inline-block;
        }

        .test-result.testing {
            background: #fff3cd;
            color: #856404;
            display: inline-block;
        }

        .current-config {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“¨ Messenger Test</h1>
            <nav>
                <a href="/">çŠ¶æ€</a>
                <a href="/config">é…ç½®</a>
                <a href="/records">è®°å½•</a>
                <a href="/messenger_test" class="active">æ¶ˆæ¯æµ‹è¯•</a>
            </nav>
        </header>

        <main>
            <div class="config-section">
                <h2>ğŸ“¬ æ”¶ä»¶äººåˆ—è¡¨</h2>
                <p class="text-muted">å½“å‰é…ç½®çš„æ”¶ä»¶äººï¼ˆä¿å­˜åœ¨ .env æ–‡ä»¶çš„ WECHAT_TOUSER å­—æ®µï¼‰</p>

                <div id="recipients-container">
                    <!-- æ”¶ä»¶äººåˆ—è¡¨å°†åŠ¨æ€ç”Ÿæˆ -->
                    <p class="text-muted">åŠ è½½ä¸­...</p>
                </div>

                <div class="actions">
                    <button type="button" class="btn btn-secondary" onclick="addNewRecipient()">
                        â• æ·»åŠ æ”¶ä»¶äºº
                    </button>
                    <button type="button" class="btn btn-success" onclick="saveRecipients()">
                        ğŸ’¾ ä¿å­˜ä¿®æ”¹
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="location.reload()">
                        ğŸ”„ é‡ç½®
                    </button>
                </div>
            </div>

            <div class="info-card">
                <h2>â„¹ï¸ ä½¿ç”¨è¯´æ˜</h2>
                <ul>
                    <li>æ¯ä¸ªæ”¶ä»¶äººå¯ä»¥å•ç‹¬ç‚¹å‡»"æµ‹è¯•"æŒ‰é’®å‘é€æµ‹è¯•æ¶ˆæ¯</li>
                    <li>æµ‹è¯•æ¶ˆæ¯åŒ…å«æ–‡å­—å’Œå›¾ç‰‡</li>
                    <li>å¯ä»¥æ·»åŠ æ–°æ”¶ä»¶äººæˆ–åˆ é™¤ç°æœ‰æ”¶ä»¶äºº</li>
                    <li>ç‚¹å‡»"ä¿å­˜ä¿®æ”¹"å°†æ›´æ”¹ä¿å­˜åˆ° .env æ–‡ä»¶</li>
                    <li>å¤šä¸ªæ”¶ä»¶äººä¼šç”¨ | åˆ†éš”ä¿å­˜</li>
                    <li><strong>è·å–useridçš„æ–¹æ³•ï¼š</strong>
                        <ul>
                            <li>åœ¨ä¼ä¸šå¾®ä¿¡ç®¡ç†åå°æŸ¥çœ‹é€šè®¯å½•</li>
                            <li>æˆ–è°ƒç”¨ä¼ä¸šå¾®ä¿¡APIè·å–æˆå‘˜åˆ—è¡¨</li>
                        </ul>
                    </li>
                </ul>
            </div>
        </main>
    </div>

    <script>
        // ä»åç«¯ä¼ é€’å½“å‰æ”¶ä»¶äººåˆ—è¡¨åˆ° JavaScript
        window.currentRecipients = '{{ current_recipients }}';
    </script>
    <script src="{{ url_for('static', filename='js/messenger_test.js') }}"></script>
</body>
</html>
